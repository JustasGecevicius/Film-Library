import{r as p,u as l,h as m}from"./index-DmAMewGY.js";import{i as A,j as b}from"./hooks-BOvKI1kO.js";import{u as C}from"./axios-C-R6KOUx.js";import{u as _}from"./firestore-B6IiNsz_.js";import{e as k}from"./hooks-CbOEPAsj.js";const h=(r,s)=>{if(!r||!s)return[];if(typeof r!="object"||Array.isArray(r)||!Array.isArray(s))return[];const{poster_sizes:o,base_url:d}=(r==null?void 0:r.images)||{},f=!Array.isArray(o)||!o.length||!d||typeof d!="string"?"":d+o[5];return s.reduce((n,e)=>{if(!e||typeof e!="object"||Array.isArray(e))return n;const{title:i,release_date:u,poster_path:a,id:t}=e;if(!i||typeof t!="number"||t<0)return n;const y=a&&typeof a=="string"&&f?f+a:"";return n.push({title:typeof i=="string"?i:"",release_date:typeof u=="string"?u:"",imageURL:y,id:t}),n},[])},O=(r,s,o=1)=>{const[d,f]=p.useState(),{userInfo:c,db:n}=l(),{config:e}=k(),{data:i}=C(["credits",s,r],()=>m.includes(r)?b(s,r):new Promise(t=>t(null)),{enabled:!!s&&!!r}),{liked:u,rated:a}=_(n,r,c==null?void 0:c.uid);return p.useEffect(()=>{if(!e||!i)return;const t=h(e,i.cast.slice(0,19*o));if(!u||!a){f(t);return}const y=A(t,Object.keys(u),a);f(y)},[e,i,u,a,o]),d};export{O as u};
