import{r as u,u as m}from"./index-CASEKhqL.js";import{i as l}from"./hooks-DFcpSZ5H.js";import{f as k,a as S}from"./functions-Xf47q2pl.js";import{u as P}from"./functions-Cg70y5OV.js";import{g as A}from"./api-D3AJ3jta.js";import{u as _}from"./firestore-Dg3MedE5.js";import{e as v}from"./hooks-D22SR9d5.js";import{a as T}from"./api-BJBHBNH-.js";const E=a=>{const[p,i]=u.useState(),{userInfo:t,db:f}=m(),{config:r}=v(),{data:{pages:n}={},fetchNextPage:g}=P(["popularData",a],({pageParam:e})=>A(a,e,!0),{getNextPageParam:e=>!Array.isArray(e)&&e.total_pages>e.page?e.page+1:void 0}),{liked:o,rated:s}=_(f,a,t==null?void 0:t.uid);return u.useEffect(()=>{if(!r||!n)return;const e=n.flatMap(({results:d})=>d),c=a==="movie"?k(r,e):S(r,e);if(!o||!s)i(c);else if(o&&s){const d=l(c,Object.keys(o),s);i(d)}},[r,n,o,s,a]),{results:p,fetchNextPage:g}},N=async(a,p=1,i)=>await T(a==="movie"?`/movie/top_rated?api_key=2e1d9e703d345ef35e7a54d9ac882a26&language=en-US&page=${p}`:`/tv/top_rated?api_key=2e1d9e703d345ef35e7a54d9ac882a26&language=en-US&page=${p}`).then(({data:t})=>i?t:t.results),h=a=>{const[p,i]=u.useState(),{userInfo:t,db:f}=m(),{config:r}=v(),{data:{pages:n}={},fetchNextPage:g}=P(["topData",a],({pageParam:e=1})=>N(a,e,!0),{getNextPageParam:e=>!Array.isArray(e)&&e.total_pages>e.page?e.page+1:void 0}),{liked:o,rated:s}=_(f,a,t==null?void 0:t.uid);return u.useEffect(()=>{if(!r||!n)return;const e=n.flatMap(({results:d})=>d),c=a==="movie"?k(r,e):S(r,e);if(!o||!s)i(c);else if(o&&s){const d=l(c,Object.keys(o),s);i(d)}},[r,n,o,s]),{results:p,fetchNextPage:g}},I={top:"Top",popular:"Popular",recommended:"Recommended",liked:"Liked",rated:"Rated",popular_friends:"Popular With Friends",rated_friends:"Rated by Friends",credits:"Credits"},L={movie:"Movies",series:"Series",people:"people"},R={popular:E,top:h};export{R as H,I as S,L as T,h as a,E as u};
