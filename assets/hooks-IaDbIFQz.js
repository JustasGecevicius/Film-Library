import{O,A as R,r as f,u as M}from"./index-C-Mk1Gwc.js";import{u}from"./axios-f8QMfS4_.js";import{l as g}from"./api-zHsTOtF1.js";import{a as L,b as h}from"./functions-B6je26cR.js";import{f as k,a as d,g as v}from"./firestore-D8GMyvQy.js";import{e as D}from"./hooks-BLlkw_ic.js";const b=e=>{const t=[];for(let s=1;s<=10;s++){const o=e.filter(r=>r===s);t.push({x:s,y:o.length})}return t},U=async(e,t,s)=>e?(await O(R(t,`${s==="movie"?"likedMovies":"likedSeries"}`,e))).data():void 0,C=async(e,t,s)=>e?(await O(R(t,`${s==="movie"?"ratedMovies":"ratedSeries"}`,e))).data():void 0,Q=(e,t)=>{const[s,o]=f.useState(),[r,a]=f.useState(),[i,c]=f.useState(),[l,S]=f.useState(),[j,x]=f.useState(),[A,F]=f.useState();return u(["ratedMovieData",t,e],()=>k(t,v("movie","rated"),e),{enabled:!!e&&!!t,onSuccess(n){if(!n)return;const m=g.round(g.mean(Object.values(n)),1);o(m||0),x(b(Object.values(n)))}}),u(["ratedSeriesData",t,e],()=>k(t,v("series","rated"),e),{enabled:!!e&&!!t,onSuccess(n){if(!n)return;const m=g.round(g.mean(Object.values(n)),1);a(m||0),F(b(Object.values(n)))}}),u(["likedMoviesData",t,e],()=>d(t,v("movie","liked"),e),{enabled:!!e&&!!t,onSuccess(n){n&&c(n)}}),u(["likedSeriesData",t,e],()=>d(t,v("series","liked"),e),{enabled:!!e&&!!t,onSuccess(n){n&&S(n)}}),{averageMovieRating:s,averageSeriesRating:r,numberOfLikedMovies:i,numberOfLikedSeries:l,differentMoviesRatings:j,differentSeriesRatings:A}},q=(e,t)=>{const[s,o]=f.useState(),{db:r}=M(),{config:a}=D(),{data:i}=u(["userLiked",e,r],()=>U(t,r,e),{enabled:!!t&&!!r&&!!e});return u(["filteredLiked",i,a,e],()=>{if(i)return e==="movie"?L(Object.keys(i),a):h(Object.keys(i),a)},{enabled:!!i&&!!a,onSuccess:c=>{o(c==null?void 0:c.map(l=>({...l,liked:!0})))}}),s},z=(e,t)=>{const[s,o]=f.useState(),{db:r}=M(),{config:a}=D(),{data:i}=u(["userRated",e,r],()=>C(t,r,e),{enabled:!!t&&!!r&&!!e}),{data:c}=u(["rated",e],()=>k(r,v(e,"rated"),t),{enabled:!!t&&!!r});return u(["filteredRated",i,a,e],()=>{if(i)return e==="movie"?L(Object.keys(i),a):h(Object.keys(i),a)},{enabled:!!i&&!!a&&!!c,onSuccess:l=>{c&&o(l==null?void 0:l.map(S=>({...S,rating:c[S.id]})))}}),s};export{q as a,z as b,Q as u};
