import{r as u,u as g}from"./index-CePdKp91.js";import{i as l}from"./hooks-B0VLHzJq.js";import{f as k,a as P}from"./functions-Xf47q2pl.js";import{u as S}from"./functions-DDbdOOuO.js";import{g as T}from"./api-DnA_JFZ8.js";import{u as A}from"./firestore-CiYGSoIR.js";import{e as v}from"./hooks-CUaYHlzA.js";import{j as _}from"./api-BC9-h-q6.js";const E=t=>{const[c,i]=u.useState(),{userInfo:a,db:f}=g(),{config:r}=v(),{data:{pages:n}={},fetchNextPage:m}=S(["popularData",t],({pageParam:e})=>T(t,e,!0),{getNextPageParam:e=>!Array.isArray(e)&&e.total_pages>e.page?e.page+1:void 0}),{liked:o,rated:s}=A(f,t,a==null?void 0:a.uid);return u.useEffect(()=>{if(!r||!n)return;const e=n.flatMap(({results:d})=>d),p=t==="movie"?k(r,e):P(r,e);if(!o||!s)i(p);else if(o&&s){const d=l(p,Object.keys(o),s);i(d)}},[r,n,o,s,t]),{results:c,fetchNextPage:m}},N=async(t,c=1,i)=>await _(`/${t==="movie"?"movie":"tv"}/top_rated?language=en-US&page=${c}`).then(({data:a})=>i?a:a.results),h=t=>{const[c,i]=u.useState(),{userInfo:a,db:f}=g(),{config:r}=v(),{data:{pages:n}={},fetchNextPage:m}=S(["topData",t],({pageParam:e=1})=>N(t,e,!0),{getNextPageParam:e=>!Array.isArray(e)&&e.total_pages>e.page?e.page+1:void 0}),{liked:o,rated:s}=A(f,t,a==null?void 0:a.uid);return u.useEffect(()=>{if(!r||!n)return;const e=n.flatMap(({results:d})=>d),p=t==="movie"?k(r,e):P(r,e);if(!o||!s)i(p);else if(o&&s){const d=l(p,Object.keys(o),s);i(d)}},[r,n,o,s]),{results:c,fetchNextPage:m}},I={top:"Top",popular:"Popular",recommended:"Recommended",liked:"Liked",rated:"Rated",popular_friends:"Popular With Friends",rated_friends:"Rated by Friends",credits:"Credits"},L={movie:"Movies",series:"Series",people:"people"},R={popular:E,top:h};export{R as H,I as S,L as T,h as a,E as u};
